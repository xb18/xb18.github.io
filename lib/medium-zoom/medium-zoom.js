!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).mediumZoom=t()}(this,function(){"use strict";function l(e){return".svg"===(e.currentSrc||e.src).substr(-4).toLowerCase()}function m(e){try{return Array.isArray(e)?e.filter(t):o(e)?[].slice.call(e).filter(t):w(e)?[e].filter(t):"string"==typeof e?[].slice.call(document.querySelectorAll(e)).filter(t):[]}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}}function E(e,t){var o,t=c({bubbles:!1,cancelable:!1,detail:void 0},t);return"function"==typeof window.CustomEvent?new CustomEvent(e,t):((o=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o)}function a(e){function t(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var i=t.reduce(function(e,t){return[].concat(e,m(t))},[]);return i.filter(function(e){return-1===p.indexOf(e)}).forEach(function(e){p.push(e),e.classList.add("medium-zoom-image")}),r.forEach(function(e){var t=e.type,o=e.listener,n=e.options;i.forEach(function(e){e.addEventListener(t,o,n)})}),b}function o(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return v.original?f():d({target:e})}var n,i=window.Promise||function(e){function t(){}e(t,t)},d=function(){function u(){var e={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},t=void 0,o=void 0,n=(z.container&&(z.container instanceof Object?(t=(e=c({},e,z.container)).width-e.left-e.right-2*z.margin,o=e.height-e.top-e.bottom-2*z.margin):(n=(a=(w(z.container)?z.container:document.querySelector(z.container)).getBoundingClientRect()).width,i=a.height,d=a.left,a=a.top,e=c({},e,{width:n,height:i,left:d,top:a}))),t=t||e.width-2*z.margin,o=o||e.height-2*z.margin,v.zoomedHd||v.original),i=!l(n)&&n.naturalWidth||t,d=!l(n)&&n.naturalHeight||o,n=(a=n.getBoundingClientRect()).top,r=a.left,m=a.width,a=a.height,i=Math.min(Math.max(m,i),t)/m,d=Math.min(Math.max(a,d),o)/a,d="scale("+(i=Math.min(i,d))+") translate3d("+((t-m)/2-r+z.margin+e.left)/i+"px, "+((o-a)/2-n+z.margin+e.top)/i+"px, 0)";v.zoomed.style.transform=d,v.zoomedHd&&(v.zoomedHd.style.transform=d)}var s=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return new i(function(t){if(s&&-1===p.indexOf(s))t(b);else{var e,o,n,i,d,r,m,a,l=function e(){g=!1,v.zoomed.removeEventListener("transitionend",e),v.original.dispatchEvent(E("medium-zoom:opened",{detail:{zoom:b}})),t(b)};if(v.zoomed)t(b);else{if(s)v.original=s;else{if(!(0<p.length))return void t(b);var c=p;v.original=c[0]}v.original.dispatchEvent(E("medium-zoom:open",{detail:{zoom:b}})),h=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,g=!0,v.zoomed=(c=v.original,e=c.getBoundingClientRect(),r=e.top,o=e.left,n=e.width,e=e.height,c=c.cloneNode(),i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,d=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,c.removeAttribute("id"),c.style.position="absolute",c.style.top=r+i+"px",c.style.left=o+d+"px",c.style.width=n+"px",c.style.height=e+"px",c.style.transform="",c),document.body.appendChild(y),z.template&&(r=w(z.template)?z.template:document.querySelector(z.template),v.template=document.createElement("div"),v.template.appendChild(r.content.cloneNode(!0)),document.body.appendChild(v.template)),v.original.parentElement&&"PICTURE"===v.original.parentElement.tagName&&v.original.currentSrc&&(v.zoomed.src=v.original.currentSrc),document.body.appendChild(v.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),v.original.classList.add("medium-zoom-image--hidden"),v.zoomed.classList.add("medium-zoom-image--opened"),v.zoomed.addEventListener("click",f),v.zoomed.addEventListener("transitionend",l),v.original.getAttribute("data-zoom-src")?(v.zoomedHd=v.zoomed.cloneNode(),v.zoomedHd.removeAttribute("srcset"),v.zoomedHd.removeAttribute("sizes"),v.zoomedHd.removeAttribute("loading"),v.zoomedHd.src=v.zoomed.getAttribute("data-zoom-src"),v.zoomedHd.onerror=function(){clearInterval(m),console.warn("Unable to reach the zoom image target "+v.zoomedHd.src),v.zoomedHd=null,u()},m=setInterval(function(){v.zoomedHd.complete&&(clearInterval(m),v.zoomedHd.classList.add("medium-zoom-image--opened"),v.zoomedHd.addEventListener("click",f),document.body.appendChild(v.zoomedHd),u())},10)):v.original.hasAttribute("srcset")?(v.zoomedHd=v.zoomed.cloneNode(),v.zoomedHd.removeAttribute("sizes"),v.zoomedHd.removeAttribute("loading"),a=v.zoomedHd.addEventListener("load",function(){v.zoomedHd.removeEventListener("load",a),v.zoomedHd.classList.add("medium-zoom-image--opened"),v.zoomedHd.addEventListener("click",f),document.body.appendChild(v.zoomedHd),u()})):u()}}})},f=function(){return new i(function(t){var e;g||!v.original?t(b):(e=function e(){v.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(v.zoomed),v.zoomedHd&&document.body.removeChild(v.zoomedHd),document.body.removeChild(y),v.zoomed.classList.remove("medium-zoom-image--opened"),v.template&&document.body.removeChild(v.template),g=!1,v.zoomed.removeEventListener("transitionend",e),v.original.dispatchEvent(E("medium-zoom:closed",{detail:{zoom:b}})),v.original=null,v.zoomed=null,v.zoomedHd=null,v.template=null,t(b)},g=!0,document.body.classList.remove("medium-zoom--opened"),v.zoomed.style.transform="",v.zoomedHd&&(v.zoomedHd.style.transform=""),v.template&&(v.template.style.transition="opacity 150ms",v.template.style.opacity=0),v.original.dispatchEvent(E("medium-zoom:close",{detail:{zoom:b}})),v.zoomed.addEventListener("transitionend",e))})},p=[],r=[],g=!1,h=0,z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},v={original:null,zoomed:null,zoomedHd:null,template:null},y=("[object Object]"===Object.prototype.toString.call(e)?z=e:!e&&"string"!=typeof e||t(e),z=c({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},z),e=z.background,(n=document.createElement("div")).classList.add("medium-zoom-overlay"),n.style.background=e,n),b=(document.addEventListener("click",function(e){e=e.target;e===y?f():-1!==p.indexOf(e)&&o({target:e})}),document.addEventListener("keyup",function(e){e=e.key||e.keyCode;"Escape"!==e&&"Esc"!==e&&27!==e||f()}),document.addEventListener("scroll",function(){var e;!g&&v.original&&(e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,Math.abs(h-e)>z.scrollOffset)&&setTimeout(f,150)}),window.addEventListener("resize",f),{open:d,close:f,toggle:o,update:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e;return e.background&&(y.style.background=e.background),e.container&&e.container instanceof Object&&(t.container=c({},z.container,e.container)),e.template&&(e=w(e.template)?e.template:document.querySelector(e.template),t.template=e),z=c({},z,t),p.forEach(function(e){e.dispatchEvent(E("medium-zoom:update",{detail:{zoom:b}}))}),b},clone:function(){return a(c({},z,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}))},attach:t,detach:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];v.zoomed&&f();var n=0<t.length?t.reduce(function(e,t){return[].concat(e,m(t))},[]):p;return n.forEach(function(e){e.classList.remove("medium-zoom-image"),e.dispatchEvent(E("medium-zoom:detach",{detail:{zoom:b}}))}),p=p.filter(function(e){return-1===n.indexOf(e)}),b},on:function(t,o){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return p.forEach(function(e){e.addEventListener("medium-zoom:"+t,o,n)}),r.push({type:"medium-zoom:"+t,listener:o,options:n}),b},off:function(t,o){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return p.forEach(function(e){e.removeEventListener("medium-zoom:"+t,o,n)}),r=r.filter(function(e){return!(e.type==="medium-zoom:"+t&&e.listener.toString()===o.toString())}),b},getOptions:function(){return z},getImages:function(){return p},getZoomedImage:function(){return v.original}});return b}var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},t=function(e){return"IMG"===e.tagName},o=function(e){return NodeList.prototype.isPrototypeOf(e)},w=function(e){return e&&1===e.nodeType};var e,n,i,d;return e=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}",n=(n=void 0===n?{}:n).insertAt,e&&"undefined"!=typeof document&&(i=document.head||document.getElementsByTagName("head")[0],(d=document.createElement("style")).type="text/css","top"===n&&i.firstChild?i.insertBefore(d,i.firstChild):i.appendChild(d),d.styleSheet?d.styleSheet.cssText=e:d.appendChild(document.createTextNode(e))),a});